<div class="chat-container">
  <!-- Room Sidebar -->
  <div class="rooms-sidebar">
    <div class="sidebar-header">
      <h3>Chat Rooms</h3>
      <button class="btn btn-sm btn-primary" (click)="createNewRoom()">+ New Room</button>
    </div>
    <div class="rooms-list">
      <div 
        *ngFor="let room of rooms" 
        class="room-item"
        [class.active]="room.id === currentRoomId"
        (click)="switchRoom(room.id!)"
      >
        <div class="room-name"># {{ room.name }}</div>
        <div class="room-description" *ngIf="room.description">{{ room.description }}</div>
      </div>
      
      <!-- Default General Room -->
      <div 
        class="room-item"
        [class.active]="currentRoomId === 'general'"
        (click)="switchRoom('general')"
      >
        <div class="room-name"># general</div>
        <div class="room-description">General discussion</div>
      </div>
    </div>
  </div>

  <!-- Chat Area -->
  <div class="chat-area">
    <!-- Chat Header -->
    <div class="chat-header">
      <h3># {{ currentRoomId }}</h3>
      <div class="user-info" *ngIf="currentUser">
        Logged in as: {{ currentUser.email }}
      </div>
    </div>

    <!-- Messages Container -->
    <div class="messages-container" #messagesContainer>
      <div *ngIf="messages.length === 0" class="no-messages">
        No messages yet. Start the conversation!
      </div>
      
      <div *ngFor="let message of messages" class="message" [class.own-message]="isCurrentUser(message)">
        <div class="message-header">
          <span class="username">{{ message.userName || message.userEmail }}</span>
          <span class="timestamp">{{ formatTimestamp(message.timestamp) }}</span>
        </div>
        <div class="message-content">{{ message.text }}</div>
      </div>
    </div>

    <!-- Message Input -->
    <div class="message-input-container">
      <div class="input-group">
        <input 
          type="text" 
          [(ngModel)]="currentMessage"
          (keypress)="onKeyPress($event)"
          placeholder="Type a message..."
          class="form-control"
          [disabled]="!currentUser || isLoading"
        >
        <button 
          class="btn btn-primary"
          (click)="sendMessage()"
          [disabled]="!currentMessage.trim() || !currentUser || isLoading"
        >
          <span *ngIf="isLoading">Sending...</span>
          <span *ngIf="!isLoading">Send</span>
        </button>
      </div>
      <div *ngIf="!currentUser" class="login-prompt">
        Please log in to send messages.
      </div>
    </div>
  </div>
</div>